{% extends 'blood/base.html' %}
{% block title %}Available Donors{% endblock %}

{% block content %}
<style>
/* 🌟 Donor List Stylish Design */
.page-header {
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
    color: white;
    text-align: center;
    padding: 25px 0;
    border-radius: 12px;
    margin-bottom: 30px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}
.donor-card {
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background: white;
}
.donor-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.2);
}
.donor-card .card-header {
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
    color: white;
    border-bottom: none;
    font-weight: 600;
    text-align: center;
}
.search-section {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}
.btn-outline-danger {
    border-radius: 25px;
    transition: 0.3s;
}
.btn-outline-danger:hover {
    background-color: #ff4b2b;
    color: white;
}
</style>

<div class="container py-4">
    <div class="page-header">
        <h2 class="fw-bold mb-1">🩸 Available Blood Donors</h2>
        <p class="mb-0">Find a suitable donor by blood group and department</p>
    </div>

    <!-- 🔍 Search Form -->
    <div class="search-section mb-4">
        <form method="GET" class="d-flex flex-wrap align-items-center justify-content-center">
            <label for="blood_group" class="me-2 fw-semibold">Filter by Blood Group:</label>
            <select name="blood_group" id="blood_group" class="form-select me-2 mb-2" style="width:150px;">
                <option value="">All</option>
                <option value="A+" {% if selected_group == "A+" %}selected{% endif %}>A+</option>
                <option value="A-" {% if selected_group == "A-" %}selected{% endif %}>A-</option>
                <option value="B+" {% if selected_group == "B+" %}selected{% endif %}>B+</option>
                <option value="B-" {% if selected_group == "B-" %}selected{% endif %}>B-</option>
                <option value="O+" {% if selected_group == "O+" %}selected{% endif %}>O+</option>
                <option value="O-" {% if selected_group == "O-" %}selected{% endif %}>O-</option>
                <option value="AB+" {% if selected_group == "AB+" %}selected{% endif %}>AB+</option>
                <option value="AB-" {% if selected_group == "AB-" %}selected{% endif %}>AB-</option>
            </select>
            <button type="submit" class="btn btn-danger mb-2">Search</button>
        </form>
    </div>

    <!-- 💉 Donor List -->
    {% if donors %}
    <div class="row">
        {% for d in donors %}
        <div class="col-md-4 mb-4">
            <div class="card donor-card">
                <div class="card-header">
                    <h5 class="mb-0">{{ d.user.username }}</h5>
                </div>
                <div class="card-body text-center">
                    {% if d.profile_pic %}
                        <img src="{{ d.profile_pic.url }}" class="rounded-circle mb-3" style="width:90px; height:90px; object-fit:cover;">
                    {% else %}
                        <img src="https://via.placeholder.com/90" class="rounded-circle mb-3" alt="Profile">
                    {% endif %}
                    <p><strong>Blood Group:</strong> {{ d.blood_group }}</p>
                    <p><strong>Department:</strong> {{ d.department }}</p>
                    <p><strong>Phone:</strong> {{ d.phone }}</p>
                    <a href="{% url 'request_donor' d.id %}" class="btn btn-outline-danger btn-sm mt-2">Request</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center mt-4">
        <p class="fw-semibold text-muted">No donors available right now 😔</p>
    </div>
    {% endif %}
</div>
{% endblock %}
